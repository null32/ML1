# Нелинейные методы восстановления регрессии

Общая идея во всех этих случаях одна: нелинейная задача сводится к решению последовательности более простых линейных задач.

## Нелинейная модель регрессии
* **f(x, a)** -- нелинейная модель регрессии
* **a** -- вектор параметров (a из **R<sup>p</sup>**)

Задача: минимизировать функционал качества:

![Функционал качества (формула)](qf.png)

Для этого используем
### метод Ньютона–Рафсона:
1. Задаем начальное **a<sup>0</sup> = (a<sup>0</sup><sub>0</sub> .. a<sup>0</sup><sub>p</sub>)**
1. **a<sup>t+1</sup> = a<sup>t</sup> - h<sub>t</sub>(Q''(a<sup>t</sup>))<sup>-1</sup> * Q'(a<sup>t</sup>)**

где
* **Q'(a<sup>t</sup>)** -- градиент функционала Q в точке **a<sup>t</sup>**
* **Q''(a<sup>t</sup>)** -- функционала Q в точке **a<sup>t</sup>**
* **h<sub>t</sub>** -- величина шага (параметр)

Компоненты градиента:

![Компоненты градиента](grad.png)

Компоненты гессиана:

![Компоненты гессиана](gess.png)

*Основная сложность метода Ньютона–Рафсона заключается в обращении гессиана на каждой итерации.*

Более эффективным в плане вычисления является
### метод Ньютона-Гаусса
Если f достаточно гладкая (дважды дифф-ая), то её можно линеаризировать в окрестности a<sup>t</sup>:

![Линеаризирование в точке](linear.png)

Тогда вторые слагаемые в гессиане равны нулю и не нужно вычислять вторые производные. В остальном метод не отличается от метода Ньютона–Рафсона.

Введем следующие обозначения:
* Матрица первых производных на t-й итерации:
![](def1.png)
* Вектор значений аппроксимирующей функции на t-й итерации:
![](def2.png)

Тогда формула итерации метода Ньютона–Рафсона принимает вид:

**a<sup>t+1</sup> = a<sup>t</sup> - h<sub>t</sub>(F<sub>t</sub><sup>T</sup>F<sub>t</sub>)<sup>-1</sup> * F<sub>t</sub><sup>T</sup>(f<sub>t</sub> - y)**

В правой части записано решение стандартной задачи многомерной линейной
регрессии. Таким образом, в методе Ньютона–Гаусса нелинейная регрессия сводится к последовательности линейных регрессионных задач.

## Нелинейные одномерные преобразования признаков
Если линейная модель для задачи не очень, можно попробовать сделать линейное преобразование и построить модель на нём:

![](lp.png)

